<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Friendly Flashback</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.light_blue-orange.min.css" />
  <link rel="stylesheet" href="/src/css/app.css">
  <link rel="stylesheet" href="/src/css/feed.css">
  <!-- Icons Below -->
  <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
    integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

  <link rel="manifest" href="/manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Friendly Flashback">
  <link rel="apple-touch-icon" href="/src/images/icons/apple-icon-57x57.png" sizes="57x57">
  <link rel="apple-touch-icon" href="/src/images/icons/apple-icon-60x60.png" sizes="60x60">
  <link rel="apple-touch-icon" href="/src/images/icons/apple-icon-72x72.png" sizes="72x72">
  <link rel="apple-touch-icon" href="/src/images/icons/apple-icon-76x76.png" sizes="76x76">
  <link rel="apple-touch-icon" href="/src/images/icons/apple-icon-114x114.png" sizes="114x114">
  <link rel="apple-touch-icon" href="/src/images/icons/apple-icon-120x120.png" sizes="120x120">
  <link rel="apple-touch-icon" href="/src/images/icons/apple-icon-144x144.png" sizes="144x144">
  <link rel="apple-touch-icon" href="/src/images/icons/apple-icon-152x152.png" sizes="152x152">
  <link rel="apple-touch-icon" href="/src/images/icons/apple-icon-180x180.png" sizes="180x180">


  <script src="https://www.gstatic.com/firebasejs/5.5.4/firebase.js"></script>



  <meta name="msapplication-TileImage" content="/src/images/icons/app-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#fff">
  <meta name="theme-color" content="#3f51b5">
</head>

<body>

  <div id="app">
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
          <!-- Title -->
          <span class="mdl-layout-title">Friendly Flashback</span>
          <!-- Add spacer, to align navigation to the right -->
          <div class="mdl-layout-spacer"></div>
          <!-- Navigation. We hide it in small screens. -->
          <nav class="mdl-navigation mdl-layout--large-screen-only">
            <a class="mdl-navigation__link" href="/">Contacts <i class="fas fa-user-circle"></i></a>
            <a class="mdl-navigation__link" href="/addContact">Add Contact</a>
            <a class="mdl-navigation__link" href="/addContact">Camera</a>
            <a onclick="mainApp.logOut()" class="mdl-navigation__link">Logout</a>



          </nav>
        </div>
      </header>
      <div class="mdl-layout__drawer">
        <span class="mdl-layout-title">Friendly Flashback</span>
        <nav class="mdl-navigation">
          <a class="mdl-navigation__link" href="/">Contacts <i class="fas fa-user-circle"></i></a>
          <a class="mdl-navigation__link" href="/addContact">Add Contact</a>
          <a class="mdl-navigation__link" href="/addContact">Camera</a>
          <a onclick="mainApp.logOut()" class="mdl-navigation__link">Logout</a>

        </nav>
      </div>



      <main class="mdl-layout__content mat-typography">


        <!-- Slide over camera====================================================================================================       -->


        <div id="create-post">
          <!-- <video id="player" autoplay></video> -->
          <canvas id="canvas" width="320px" height="240px"></canvas>
          <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" id="stopAndStop">Capture
          </button>


          <!-- NEW STUFF ============================================ -->



          <style>
            #codeEditor, #videoInput{
            display:none;
            /* ******  ***** *** display:inline; This will show the code and original video*/
        }
</style>

          <!--The style above hides the code below-->
          <textarea class="code" rows="29" cols="80" id="codeEditor" spellcheck="false"></textarea>





          <p class="err" id="errorMessage"></p>
          <div>

            <video id="videoInput" width=320 height=240></video>

            <canvas id="canvasOutput" width=300 height=240 style="display: block;margin: 0 auto;"></canvas>

            <div class="control"><button id="startAndStop" disabled>Screen Capture</button></div>


            <a href="../">Return Home</a>



          </div>
          <script src="https://webrtc.github.io/adapter/adapter-5.0.4.js" type="text/javascript"></script>
          <script src="utils.js" type="text/javascript"></script>



          <script id="codeSnippet" type="text/code-snippet">
let video = document.getElementById('videoInput');
let src = new cv.Mat(video.height, video.width, cv.CV_8UC4);
let dst = new cv.Mat(video.height, video.width, cv.CV_8UC4);
let gray = new cv.Mat();
let cap = new cv.VideoCapture(video);
let faces = new cv.RectVector();
let classifier = new cv.CascadeClassifier();

// load pre-trained classifiers
classifier.load('haarcascade_frontalface_default.xml');

const FPS = 30;
function processVideo() {
try {
    if (!streaming) {
        // clean and stop.
        src.delete();
        dst.delete();
        gray.delete();
        faces.delete();
        classifier.delete();
        return;
    }
    let begin = Date.now();
    // start processing.
    cap.read(src);
    src.copyTo(dst);
    cv.cvtColor(dst, gray, cv.COLOR_RGBA2GRAY, 0);
    // detect faces.
    classifier.detectMultiScale(gray, faces, 1.1, 3, 0);
    // draw faces.
    for (let i = 0; i < faces.size(); ++i) {
        let face = faces.get(i);
        let point1 = new cv.Point(face.x, face.y);
        let point2 = new cv.Point(face.x + face.width, face.y + face.height);
        cv.rectangle(dst, point1, point2, [255, 0, 0, 255]);
    }
    cv.imshow('canvasOutput', dst);
    // schedule the next one.
    let delay = 1000/FPS - (Date.now() - begin);
    setTimeout(processVideo, delay);
} catch (err) {
    utils.printError(err);
}
};

// schedule the first one.
setTimeout(processVideo, 0);
</script>





          <script type="text/javascript">
            let utils = new Utils('errorMessage');

            utils.loadCode('codeSnippet', 'codeEditor');

            let streaming = false;
            let videoInput = document.getElementById('videoInput');
            let startAndStop = document.getElementById('startAndStop');
            let canvasOutput = document.getElementById('canvasOutput');
            let canvasContext = canvasOutput.getContext('2d');

            startAndStop.addEventListener('click', () => {
              if (!streaming) {
                utils.clearError();
                utils.startCamera('qvga', onVideoStarted, 'videoInput');
              } else {
                utils.stopCamera();
                onVideoStopped();
              }
            });

            function onVideoStarted() {
              streaming = true;
              startAndStop.innerText = 'Stop';
              videoInput.width = videoInput.videoWidth;
              videoInput.height = videoInput.videoHeight;
              utils.executeCode('codeEditor');
            }

            function onVideoStopped() {
              streaming = false;
              canvasContext.clearRect(0, 0, canvasOutput.width, canvasOutput.height);
              startAndStop.innerText = 'Start';
            }

            utils.loadOpenCv(() => {
              let faceCascadeFile = 'haarcascade_frontalface_default.xml';
              utils.createFileFromUrl(faceCascadeFile, faceCascadeFile, () => {
                startAndStop.removeAttribute('disabled');
              });
            });




          </script>







          <!-- END NEW STUFF ============================================== -->






          <button class="mdl-button mdl-js-button mdl-button--fab" id="close-create-post-modal-btn" type="button">
            <i class="material-icons">close</i>
          </button>








        </div>



        <!--END Slide over camera====================================================================================================       -->



        <!-- <img src="/src/images/main-image.jpg" srcset="/src/images/main-image-lg.jpg 1200w,
                   /src/images/main-image.jpg 900w,
                   /src/images/main-image-sm.jpg 480w"
          alt="Explore the City" class="main-image"> -->
        <img src="/src/images/mountain-croped.jpg" srcset="/src/images/mountain-croped.jpg 1200w,
          /src/images/mountain-croped.jpg 900w,
          /src/images/mountain-croped.jpg 480w"
          alt="Explore the City" class="main-image">

        <div class="page-content">
          <h5 class="text-center mdl-color-text--primary">Contacts for <span id="displayName"></span>
          </h5>



          <!-- Icon List -->
          <style>
            .demo-list-icon {
    width: 300px;
  }
  </style>

          <ul class="demo-list-icon mdl-list">
              <li class="mdl-list__item">
                  <span class="mdl-list__item-primary-content">
                    <i class="material-icons mdl-list__item-icon">person</i>
                    Robert, {relation}
                  </span>
                </li>
            <li class="mdl-list__item">
              <span class="mdl-list__item-primary-content">
                <i class="material-icons mdl-list__item-icon">person</i>
                Gabe, {relation}
              </span>
            </li>
            <li class="mdl-list__item">
              <span class="mdl-list__item-primary-content">
                <i class="material-icons mdl-list__item-icon">person</i>
                Tyler, {relation}
              </span>
            </li>
            <li class="mdl-list__item">
              <span class="mdl-list__item-primary-content">
                <i class="material-icons mdl-list__item-icon">person</i>
                Zilin, {relation}
              </span>
            </li>
            <li class="mdl-list__item">
              <span class="mdl-list__item-primary-content">
                <i class="material-icons mdl-list__item-icon">person</i>
                Jacob, {relation}
              </span>
            </li><li class="mdl-list__item">
              <span class="mdl-list__item-primary-content">
                <i class="material-icons mdl-list__item-icon">person</i>
                Irald, {relation}
              </span>
            </li>




          </ul>




          <!-- Dynamic content get inserted in the div below
          <div id="shared-moments"></div>
          Dynamic content get inserted in the div below -->




        </div>
        <div class="floating-button">
          <button class="mdl-button mdl-js-button mdl-button--fab mdl-button--colored" id="share-image-button">
            <i class="material-icons">camera_alt</i>
          </button>
        </div>
        <div id="confirmation-toast" aria-live="assertive" aria-atomic="true" aria-relevant="text" class="mdl-snackbar mdl-js-snackbar">
          <div class="mdl-snackbar__text"></div>
          <button type="button" class="mdl-snackbar__action"></button>
        </div>
      </main>

      <!--End Slide over camera====================================================================================================       -->


    </div>
  </div>


  <script src="./fireBase.js"></script>
  <script src="./index.js"></script>


  <script async src="/src/js/opencv.js" onload="onOpenCvReady();" type="text/javascript"></script>
  <script defer src="/src/js/material.min.js"></script>
  <script src="/src/js/promise.js"></script>
  <script src="/src/js/fetch.js"></script>
  <script src="/src/js/idb.js"></script>
  <script src="/src/js/utility.js"></script>
  <script src="/src/js/app.js"></script>
  <script src="/src/js/feed.js"></script>
</body>

</html>